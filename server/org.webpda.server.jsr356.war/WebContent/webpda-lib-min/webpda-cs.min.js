WebPDA_CS={};
(function(){function k(a,b){var d=a.binData,g=a.startIndex,h=(new Int16Array(d,g,1))[0],e=new Uint8Array(d,g+4,h),e=WebPDA_Util.decodeUTF8Array(e),e=JSON.parse(e),f;for(f in e){var c=e[f];switch(f){case "type":b=l(e.type);break;case "t":b.timestamp=new WebPDA_CS.Timestamp(c.s,c.ns);break;case "v":b.parseBinaryValue(c);break;case "sev":b.severity=c;break;case "an":b.alarmName=c;break;case "dl":b.display.displayLow=c;break;case "dh":b.display.displayHigh=c;break;case "wl":b.display.warnLow=c;break;
case "wh":b.display.warnHigh=c;break;case "al":b.display.alarmLow=c;break;case "ah":b.display.alarmHigh=c;break;case "prec":b.display.precision=c;break;case "units":b.display.units=c;break;case "labels":b.labels=c;break;case "len":b.length=c;break;default:throw Error("Unkown Json Property: "+f);}}f=h+g+4+b.getBinValueLength();0<b.getBinValueLength()&&b.parseBinaryValue(d,h+g+4);a.startIndex=f;return b}function l(a){switch(a){case "VDouble":case "VFloat":case "VLong":case "VInt":case "VShort":case "VByte":return new WebPDA_CS.VNumber(a);
case "VString":return new WebPDA_CS.VString(a);case "VEnum":return new WebPDA_CS.VEnum(a);case "VDoubleArray":case "VFloatArray":case "VLongArray":case "VIntArray":case "VShortArray":case "VByteArray":return new WebPDA_CS.VNumberArray(a);case "VStringArray":return new WebPDA_CS.VStringArray(a);case "VEnumArray":return new WebPDA_CS.VEnumArray(a);default:throw Error("Unknown data type: "+a);}}WebPDA.prototype.createPV=function(a,b,d){return this.internalCreatePV(a,{pvName:a,parameters:{minUpdatePeriodInMs:b,
bufferAllValues:d}},function(a,b){return null==b||void 0==b||a.pvName!=b.pvName||a.parameters.minUpdatePeriodInMs!=b.parameters.minUpdatePeriodInMs||a.parameters.bufferAllValues!=b.parameters.bufferAllValues?!1:!0},d)};WebPDA.prototype.processJsonForPV=function(a,b){switch(b.e){case "conn":a.connected=b.d;break;case "val":a.value=k({binData:b.d,startIndex:8},a.value);break;case "bufVal":a.allBufferedValues=[];for(var d={binData:b.d,startIndex:8};d.startIndex<b.d.byteLength-1;)a.value=k(d,a.value),
a.allBufferedValues.push(a.value.clone());break;case "writePermission":a.writeAllowed=b.d}WebPDA_Debug&&console.log(this)};WebPDA_CS.Timestamp=function(a,b){this.sec=a;this.nanoSec=b;this.toString=function(){return WebPDA_Util.formatDate(this.getDate())}};WebPDA_CS.Timestamp.prototype.getDate=function(){null==this.date&&(this.date=new Date(1E3*this.sec+this.nanoSec/1E6));return this.date};WebPDA_CS.Display=function(){this.units=this.precision=this.alarmHigh=this.alarmLow=this.warnHigh=this.warnLow=
this.displayHigh=this.displayLow=null};WebPDA_CS.VBasicType=function(a){this.alarmName=this.severity=this.value=this.timestamp=null;this.type=a};WebPDA_CS.VBasicType.prototype.toString=function(){return"["+this.type+"] "+this.timestamp+" "+this.value+" "+this.severity+" "+this.alarmName};WebPDA_CS.VBasicType.prototype.clone=function(){var a={},b;for(b in this)a[b]="value"!=b&&"object"==typeof this[b]&&null!=this[b]?WebPDA_Util.clone(this[b]):this[b];return a};WebPDA_CS.VBasicType.prototype.getBinValueLength=
function(){throw Error("This function must be overriden by subclass");};WebPDA_CS.VNumber=function(a){WebPDA_CS.VBasicType.call(this,a);this.display=new WebPDA_CS.Display};WebPDA_CS.VNumber.prototype=new WebPDA_CS.VBasicType;WebPDA_CS.VNumber.prototype.parseBinaryValue=function(a,b){switch(this.type){case "VDouble":case "VLong":this.value=(new Float64Array(a,b,1))[0];break;case "VFloat":this.value=(new Float32Array(a,b,1))[0];break;case "VInt":this.value=(new Int32Array(a,b,1))[0];break;case "VShort":this.value=
(new Int16Array(a,b,1))[0];break;case "VByte":this.value=(new Int8Array(a,b,1))[0];break;default:throw Error("This is not a VNumber type: "+type);}};WebPDA_CS.VNumber.prototype.getBinValueLength=function(){switch(this.type){case "VDouble":case "VLong":return 8;case "VFloat":case "VInt":return 4;case "VShort":return 2;case "VByte":return 1;default:throw Error("This is not a VNumber type: "+type);}};WebPDA_CS.VNumberArray=function(a){WebPDA_CS.VNumber.call(this,a);this.length=null};WebPDA_CS.VNumberArray.prototype=
new WebPDA_CS.VNumber;WebPDA_CS.VNumberArray.prototype.parseBinaryValue=function(a,b){switch(this.type){case "VDoubleArray":case "VLongArray":this.value=new Float64Array(a,b,this.length);break;case "VFloatArray":this.value=new Float32Array(a,b,this.length);break;case "VIntArray":this.value=new Int32Array(a,b,this.length);break;case "VShortArray":this.value=new Int16Array(a,b,this.length);break;case "VByteArray":this.value=new Int8Array(a,b,this.length);break;default:throw Error("This is not a VNumberArray type: "+
type);}};WebPDA_CS.VNumberArray.prototype.getBinValueLength=function(){switch(this.type){case "VDoubleArray":case "VLongArray":return 8*this.length;case "VIntArray":case "VFloatArray":return 4*this.length;case "VShortArray":return 2*this.length;case "VByteArray":return this.length;default:throw Error("This is not a VNumberArray type: "+type);}};WebPDA_CS.VNumberArray.prototype.toString=function(){return"["+this.type+"] "+this.timestamp+" ["+this.value.length+" "+this.value[0]+"..."+this.value[this.value.length-
1]+"] "+this.severity+" "+this.alarmName};WebPDA_CS.VString=function(a){WebPDA_CS.VBasicType.call(this,a)};WebPDA_CS.VString.prototype=new WebPDA_CS.VBasicType;WebPDA_CS.VString.prototype.parseBinaryValue=function(a){this.value=a};WebPDA_CS.VString.prototype.getBinValueLength=function(){return 0};WebPDA_CS.VStringArray=function(a){WebPDA_CS.VString.call(this,a);this.value=jsonValue};WebPDA_CS.VStringArray.prototype=new WebPDA_CS.VString;WebPDA_CS.VEnum=function(a){WebPDA_CS.VBasicType.call(this,a);
this.labels=[]};WebPDA_CS.VEnum.prototype=new WebPDA_CS.VBasicType;WebPDA_CS.VEnum.prototype.parseBinaryValue=function(a,b){this.value=(new Int32Array(a,b,1))[0]};WebPDA_CS.VEnum.prototype.getBinValueLength=function(){return 4};WebPDA_CS.VEnum.prototype.toString=function(){return"["+this.type+"] "+this.timestamp+" "+this.labels[this.value]+" "+this.alarmName};WebPDA_CS.VEnumArray=function(a){WebPDA_CS.VEnum.call(this,a)};WebPDA_CS.VEnumArray.prototype=new WebPDA_CS.VEnum;WebPDA_CS.VEnumArray.prototype.parseBinaryValue=
function(a,b){this.value=new Int32Array(a,b,this.length)};WebPDA_CS.VEnumArray.prototype.getBinValueLength=function(){return 4*this.length};WebPDA_CS.VEnumArray.prototype.toString=function(){return"["+this.type+"] "+this.timestamp+" ["+this.value.length+" "+this.value+this.value[0]+"..."+this.value[this.value.length-1]+"] "+this.severity+" "+this.alarmName}})();