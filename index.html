<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="WebPDA : WebSocket based Process Data Access" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>WebPDA</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/xihui/WebPDA">View on GitHub</a>

          <h1 id="project_title">WebPDA</h1>
          <h2 id="project_tagline">WebSocket based Process Data Access</h2>

            <section id="downloads">
              <a class="zip_download_link" href="release/1.0.0/webpda.war">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/xihui/WebPDA/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="websocket-based-process-data-access" class="anchor" href="#websocket-based-process-data-access"><span class="octicon octicon-link"></span></a>WebSocket based Process Data Access</h1>

<p>WebSocket based Process Data Access (WebPDA) is a protocol to access process data using standard WebSocket technology. </p>

<p>Process data is data related to a process, during which the value of a variable may change along with a process. </p>

<p>The variable in a process is called <a href="http://en.wikipedia.org/wiki/Process_variable">Process Variable (PV)</a>. For example,
the temperature of a furnace,  the price of a stock, the blood pressure of a person can all be considered as PV,
so WebPDA can be widely used for SCADA, financial, health, weather, environment monitoring, measurement and control systems etc,.</p>

<h2>
<a name="goals--features" class="anchor" href="#goals--features"><span class="octicon octicon-link"></span></a>Goals &amp; features:</h2>

<p>WebPDA provided a simple and general way to push realtime changing process data to the web. </p>

<p>On server side, it provides an interface that allows easy extension of data sources. 
Currently, it only has Java implementation using JSR356 with Glassfish. Potentially, it can 
be implemented with any language that supports WebSocket. 
Currently, it has a control system data source implemented on <a href="http://pvmanager.sourceforge.net/">PVManager</a>, so it can be used for control system 
such as <a href="http://www.aps.anl.gov/epics/">EPICS</a>.</p>

<p>On client side,  it allows corresponding extension to parse the newly added data source on server side.
The client side can also be implemented with any language that supports WebSocket. Currently,
it provides a JavaScript library for web browser.</p>

<h2>
<a name="web-browser-client-example" class="anchor" href="#web-browser-client-example"><span class="octicon octicon-link"></span></a>Web Browser Client Example</h2>

<p>webpda-core.js is the core of WebPDA JavaScript library.
The control system extension is webpda-cs.js.</p>

<p>HTML page</p>

<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"webpda-core.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"webpda-cs.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
sim://noise <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Close PV"</span> <span class="na">onclick=</span><span class="s">"closePV();"</span> <span class="nt">/&gt;&lt;br&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"output"</span><span class="nt">&gt;</span>Output:<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"simpledemo.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<p>simpledemo.js</p>

<div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">wsUri</span> <span class="o">=</span> <span class="s2">"ws://localhost:8080/org.webpda.server.jsr356.war/webpda"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">wp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebPDA</span><span class="p">(</span><span class="nx">wsUri</span><span class="p">,</span> <span class="s2">"webpda"</span><span class="p">,</span> <span class="s2">"123456"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"output"</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">writeToScreen</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">output</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="nx">message</span> <span class="o">+</span> <span class="s2">"&lt;br&gt;"</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// create a pv whose name is sim://noise, maximum update rate at 1hz, don't buffer value.</span>
<span class="kd">var</span> <span class="nx">pv</span> <span class="o">=</span> <span class="nx">wp</span><span class="p">.</span><span class="nx">createPV</span><span class="p">(</span><span class="s2">"sim://noise"</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

<span class="c1">// add listener to the pv.</span>
<span class="nx">pv</span><span class="p">.</span><span class="nx">addListenerFunc</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">,</span> <span class="nx">pv</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="s2">"conn"</span><span class="o">:</span>
        <span class="nx">writeToScreen</span><span class="p">(</span><span class="s2">"connected"</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">"val"</span><span class="o">:</span>
        <span class="nx">writeToScreen</span><span class="p">(</span><span class="nx">pv</span><span class="p">.</span><span class="nx">getValue</span><span class="p">());</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">"bufVal"</span><span class="o">:</span>
        <span class="c1">// if value is buffered, it will receive an array of buffered values.</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">"error"</span><span class="o">:</span>
        <span class="nx">writeToScreen</span><span class="p">(</span><span class="s2">"Error: "</span> <span class="o">+</span> <span class="nx">data</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">"writePermission"</span><span class="o">:</span>
        <span class="c1">// write permission changed.</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="s2">"writeFinished"</span><span class="o">:</span>
        <span class="c1">// write operation finished.</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">function</span> <span class="nx">closePV</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">pv</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">}</span>

</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">WebPDA maintained by <a href="https://github.com/xihui">xihui</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-13250727-5");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
